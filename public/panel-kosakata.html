<!DOCTYPE html><html lang="id"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale-1"><title>Panel Kosakata</title><script src="https://cdn.tailwindcss.com"></script><script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script></head><body class="bg-stone-50 antialiased min-h-screen"><nav class="bg-white border-b border-stone-200 backdrop-blur-sm bg-white/90 sticky top-0 z-10"><div class="container mx-auto px-4 sm:px-6 lg:px-8 py-4 flex flex-wrap justify-between items-center gap-4"><h1 id="panel-title" class="text-lg font-semibold text-stone-900 tracking-tight">Kelola Kosakata</h1><div class="flex items-center gap-3"><a href="/dashboard" class="text-sm font-medium text-stone-600 hover:text-stone-900 transition-colors duration-200">Kembali ke Dashboard</a> <a href="/api/logout" class="inline-flex items-center justify-center px-4 py-2 text-sm font-medium text-white bg-stone-900 hover:bg-stone-800 rounded-lg transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-stone-900 focus:ring-offset-2">Logout</a></div></div></nav><main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 sm:py-12 max-w-5xl"><div class="bg-white rounded-xl border border-stone-200 shadow-sm p-6 sm:p-8 mb-8"><h2 id="form-title" class="text-xl font-semibold text-stone-900 mb-6 tracking-tight">Tambah Kosakata Baru</h2><form id="add-vocab-form" class="space-y-5"><input type="hidden" id="editingId" value=""><div><label for="kosakata" class="block text-sm font-medium text-stone-700 mb-2">Kosakata (Jepang)</label> <input type="text" id="kosakata" name="kosakata" class="w-full px-4 py-2.5 text-sm text-stone-900 bg-white border border-stone-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-stone-900 focus:border-transparent transition-all duration-200 placeholder:text-stone-400" placeholder="Contoh: 新しい (atarashii)" required></div><div><label for="arti" class="block text-sm font-medium text-stone-700 mb-2">Arti (Indonesia)</label> <input type="text" id="arti" name="arti" class="w-full px-4 py-2.5 text-sm text-stone-900 bg-white border border-stone-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-stone-900 focus:border-transparent transition-all duration-200 placeholder:text-stone-400" placeholder="Contoh: Baru" required></div><div><label for="image_url" class="block text-sm font-medium text-stone-700 mb-2">URL Thumbnail (Opsional)</label> <input type="url" id="image_url" name="image_url" class="w-full px-4 py-2.5 text-sm text-stone-900 bg-white border border-stone-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-stone-900 focus:border-transparent transition-all duration-200 placeholder:text-stone-400" placeholder="https://... (URL gambar ilustrasi)"></div><div class="flex items-center gap-3"><button type="submit" id="submit-button" class="inline-flex items-center justify-center px-5 py-2.5 text-sm font-medium text-white bg-stone-900 hover:bg-stone-800 rounded-lg transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-stone-900 focus:ring-offset-2">Simpan Kosakata</button> <button type="button" id="cancel-edit-button" class="hidden inline-flex items-center justify-center px-5 py-2.5 text-sm font-medium text-stone-700 bg-stone-100 hover:bg-stone-200 rounded-lg transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-stone-900 focus:ring-offset-2">Batal Edit</button></div></form></div><div class="bg-white rounded-xl border border-stone-200 shadow-sm p-6 sm:p-8"><h2 class="text-xl font-semibold text-stone-900 mb-6 tracking-tight">Daftar Kosakata</h2><div id="vocab-list" class="space-y-3"><p class="text-sm text-stone-500">Memuat...</p></div></div></main><script>var c=(a,e,t)=>new Promise((s,i)=>{var o=n=>{try{r(t.next(n))}catch(d){i(d)}},l=n=>{try{r(t.throw(n))}catch(d){i(d)}},r=n=>n.done?s(n.value):Promise.resolve(n.value).then(o,l);r((t=t.apply(a,e)).next())});const urlParams=new URLSearchParams(window.location.search),babId=urlParams.get("babId"),babTitle=urlParams.get("title");document.getElementById("panel-title").textContent=`Kelola Kosakata: ${babTitle||""}`,document.title=`Panel Kosakata - ${babTitle||""}`;const form=document.getElementById("add-vocab-form"),listContainer=document.getElementById("vocab-list"),formTitle=document.getElementById("form-title"),submitButton=document.getElementById("submit-button"),cancelEditButton=document.getElementById("cancel-edit-button"),editingIdInput=document.getElementById("editingId"),kosakataInput=document.getElementById("kosakata"),artiInput=document.getElementById("arti"),imageUrlInput=document.getElementById("image_url"),showToast=(a,e="success")=>{Swal.fire({toast:!0,position:"top-end",icon:e,title:a,showConfirmButton:!1,timer:3e3,timerProgressBar:!0})};function fetchVocab(){return c(this,null,function*(){if(!babId){listContainer.innerHTML='<p class="text-sm text-red-600">ID Bab tidak ditemukan.</p>';return}try{const e=yield(yield fetch(`/api/vocabularies/${babId}`)).json();if(listContainer.innerHTML="",e.length===0){listContainer.innerHTML='<p class="text-sm text-stone-500">Belum ada kosakata.</p>';return}e.forEach(t=>{const s=t.image_url?t.image_url:"Tidak ada gambar";listContainer.innerHTML+=`
            <div class="border border-stone-200 rounded-lg p-4 sm:p-5 hover:border-stone-300 transition-colors duration-200">
              <div class="flex flex-col md:flex-row md:items-start md:justify-between gap-4">
                <div class="flex-1 min-w-0">
                  <p class="text-lg font-semibold text-stone-900">${t.kosakata||""}</p>
                  <p class="text-sm text-stone-700 mt-1">${t.arti||""}</p>
                  <p class="text-xs text-stone-500 mt-2 truncate" title="${s}">
                    URL: ${s}
                  </p>
                </div>
                <div class="flex-shrink-0 flex items-center gap-2 mt-3 md:mt-0">
                  <button class="edit-btn inline-flex items-center justify-center px-3 py-2 text-xs font-medium text-white bg-stone-900 hover:bg-stone-800 rounded-md" data-id="${t.id}">
                    Edit
                  </button>
                  <button class="delete-btn inline-flex items-center justify-center px-3 py-2 text-xs font-medium text-white bg-red-600 hover:bg-red-700 rounded-md" data-id="${t.id}">
                    Hapus
                  </button>
                </div>
              </div>
            </div>
          `})}catch(a){listContainer.innerHTML='<p class="text-sm text-red-600">Gagal memuat data.</p>'}})}form.addEventListener("submit",a=>c(null,null,function*(){a.preventDefault();const e=kosakataInput.value,t=artiInput.value,s=imageUrlInput.value.trim();if(!e||!t){showToast("Kosakata dan Arti tidak boleh kosong!","warning");return}const i=editingIdInput.value,o=!!i,l=o?`/api/vocabularies/${i}`:"/api/vocabularies",r=o?"PUT":"POST",n={kosakata:e,arti:t,image_url:s||null};o||(n.bab_id=babId);const d=JSON.stringify(n);try{if(!(yield fetch(l,{method:r,headers:{"Content-Type":"application/json"},body:d})).ok)throw new Error(o?"Gagal memperbarui":"Gagal menyimpan");resetForm(),fetchVocab(),showToast(o?"Kosakata berhasil diperbarui.":"Kosakata berhasil disimpan.")}catch(m){showToast(m.message,"error")}})),listContainer.addEventListener("click",a=>{const e=a.target.closest("button");if(!e)return;const t=e.dataset.id;e.classList.contains("delete-btn")?deleteVocab(t):e.classList.contains("edit-btn")&&editVocab(t)});function deleteVocab(a){Swal.fire({title:"Anda yakin?",text:"Kosakata ini akan dihapus permanen.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",cancelButtonText:"Batal",confirmButtonText:"Ya, hapus!"}).then(e=>c(null,null,function*(){if(e.isConfirmed)try{if(!(yield fetch(`/api/vocabularies/${a}`,{method:"DELETE"})).ok)throw new Error("Gagal menghapus");fetchVocab(),showToast("Konten berhasil dihapus."),resetForm()}catch(t){showToast(t.message,"error")}}))}function editVocab(a){return c(this,null,function*(){try{const e=yield fetch(`/api/vocabulary/${a}`);if(!e.ok)throw new Error("Gagal mengambil data");const t=yield e.json();kosakataInput.value=t.kosakata||"",artiInput.value=t.arti||"",imageUrlInput.value=t.image_url||"",editingIdInput.value=t.id,formTitle.textContent="Edit Konten Kosakata",submitButton.textContent="Simpan Perubahan",cancelEditButton.classList.remove("hidden"),window.scrollTo({top:0,behavior:"smooth"}),kosakataInput.focus()}catch(e){showToast(e.message,"error")}})}function resetForm(){form.reset(),editingIdInput.value="",formTitle.textContent="Tambah Kosakata Baru",submitButton.textContent="Simpan Kosakata",cancelEditButton.classList.add("hidden")}cancelEditButton.addEventListener("click",resetForm),document.addEventListener("DOMContentLoaded",fetchVocab);</script></body></html>