<!DOCTYPE html><html lang="id"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>勉強中</title><script src="https://cdn.tailwindcss.com"></script><link href="https://cdn.jsdelivr.net/npm/quill@2.0.0/dist/quill.snow.css" rel="stylesheet"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"><script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"><script src="https://unpkg.com/wanakana"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@uploadcare/uc-video/dist/style.css"><script>const THEME_KEY="theme-preference",htmlEl=document.documentElement,applyTheme=e=>{e==="dark"?htmlEl.classList.add("dark"):htmlEl.classList.remove("dark"),localStorage.setItem(THEME_KEY,e)},getPreferredTheme=()=>{const e=localStorage.getItem(THEME_KEY);return e||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")},currentTheme=getPreferredTheme();applyTheme(currentTheme);</script><style>audio{width:100%;margin-top:.5rem}.choukai-script-container{max-height:0;overflow:hidden;transition:max-height .5s ease-out,padding-top .5s ease-out,margin-top .5s ease-out;background-color:var(--bg-color);border-top:1px solid transparent;margin-top:0;padding-top:0}.choukai-script-container.visible{max-height:1000px;margin-top:1rem;padding-top:1rem;border-top-color:var(--border-color);transition:max-height .5s ease-in,padding-top .5s ease-in,margin-top .5s ease-in}.choukai-script-container .ql-editor{padding-top:.5rem}.ql-container.ql-snow{border:none}.ql-editor{padding:0;font-size:1rem;line-height:1.7}.ql-editor p{margin-bottom:1em}:root{--bg-color:#f5f5f4;--text-color-p:#333;--bg-header:rgba(255, 255, 255, 0.9);--border-color:#e7e5e4;--text-primary:#1c1917;--text-secondary:#78716c;--card-bg:#ffffff;--card-hover:#f5f5f4;--button-hover:#e7e5e4}.dark{--bg-color:#1c1917;--text-color-p:#e5e5e5;--bg-header:#272322;--border-color:#44403c;--text-primary:#f5f5f4;--text-secondary:#a8a29e;--card-bg:#292524;--card-hover:#3f3f46;--button-hover:#3f3f46}body{background-color:var(--bg-color);color:var(--text-primary);transition:background-color .3s ease,color .3s ease}p{color:var(--text-color-p);transition:color .3s ease}.ql-editor{color:var(--text-color-p)}.ql-editor p{color:var(--text-color-p)}.dark .ql-editor strong{color:var(--text-primary)}header{background-color:var(--bg-header);border-color:var(--border-color);transition:background-color .3s ease,border-color .3s ease}#tab-nav{border-color:var(--border-color);transition:border-color .3s ease}#chapter-title,#tab-nav button,header a{color:var(--text-secondary);transition:color .3s ease,border-color .3s ease}#tab-nav button:hover,header a:hover{color:var(--text-primary);border-color:var(--text-secondary)}#tab-nav button.border-stone-900{color:var(--text-primary);border-color:var(--text-primary)}.dark #tab-nav button.border-stone-900{border-color:var(--text-primary)}.dark .bg-white{background-color:var(--card-bg)}.dark .border-stone-100{border-color:var(--border-color)}.dark .border-stone-200{border-color:var(--border-color)}.dark .text-stone-900{color:var(--text-primary)}.dark .text-stone-800{color:var(--text-primary)}.dark .text-stone-700{color:var(--text-primary)}.dark .text-stone-600{color:var(--text-secondary)}.dark .text-stone-500{color:var(--text-secondary)}.dark .bg-stone-100{background-color:var(--bg-color)}.dark .hover\:bg-stone-50:hover{background-color:var(--card-hover)}.dark .hover\:bg-stone-100:hover{background-color:var(--button-hover)}.dark .hover\:bg-stone-200:hover{background-color:var(--button-hover)}.dark .bg-stone-900{background-color:var(--text-primary)}.dark .hover\:bg-stone-800:hover{background-color:var(--text-secondary)}.dark .focus\:ring-stone-900:focus{--tw-ring-color:var(--text-primary)}.dark .text-stone-900.focus\:ring-stone-900{color:var(--text-primary)}#romaji-toggle-btn,#theme-toggle-btn{color:var(--text-secondary);position:relative}#romaji-toggle-btn:hover,#theme-toggle-btn:hover{color:var(--text-primary);background-color:var(--button-hover)}#theme-toggle-btn i{transition:transform .3s ease,opacity .3s ease}.vocab-card-image-placeholder{background-color:var(--border-color);display:flex;align-items:center;justify-content:center;color:var(--text-secondary)}#image-modal{transition:opacity .3s ease,visibility .3s ease}#image-modal.hidden{opacity:0;visibility:hidden}#image-modal:not(.hidden)>div{transform:scale(1)}#image-modal .swiper{width:100%;height:100%;max-height:80vh}#image-modal .swiper-slide{text-align:center;font-size:18px;background:0 0;display:flex;justify-content:center;align-items:center}#image-modal .swiper-slide img{display:block;width:auto;height:auto;max-width:100%;max-height:80vh;object-fit:contain;border-radius:.375rem}#image-modal .swiper-button-next,#image-modal .swiper-button-prev{color:#fff;background-color:rgba(0,0,0,.3);width:44px;height:44px;border-radius:9999px;transition:background-color .2s ease}#image-modal .swiper-button-next:hover,#image-modal .swiper-button-prev:hover{background-color:rgba(0,0,0,.5)}#image-modal .swiper-button-next::after,#image-modal .swiper-button-prev::after{font-size:20px;font-weight:700}#image-modal .swiper-pagination-bullet{background:#fff;opacity:.7}#image-modal .swiper-pagination-bullet-active{opacity:1;background:#fff}.youtube-container{position:relative}</style></head><body class="min-h-screen antialiased"><header class="border-b border-stone-200 sticky top-0 z-10 backdrop-blur-sm"><nav class="container mx-auto px-4 sm:px-6 lg:px-8 py-5 flex justify-between items-center gap-4"><a href="/" class="text-sm font-medium transition-colors duration-200 flex items-center gap-2 group"><span class="transform group-hover:-translate-x-1 transition-transform duration-200">&larr;</span> <span>Kembali ke Daftar</span></a><div class="flex items-center gap-2 sm:gap-4"><h2 id="chapter-title" class="text-sm font-medium text-right truncate max-w-[150px] sm:max-w-md">Memuat...</h2><button id="romaji-toggle-btn" class="flex-shrink-0 w-10 h-10 flex items-center justify-center rounded-full transition-colors duration-200" aria-label="Toggle Romaji"><span id="romaji-toggle-icon" class="text-lg font-bold select-none">あ</span></button> <button id="theme-toggle-btn" class="flex-shrink-0 w-10 h-10 flex items-center justify-center rounded-full transition-colors duration-200" aria-label="Toggle dark mode"><i id="theme-icon-sun" class="fa-solid fa-sun text-xl"></i> <i id="theme-icon-moon" class="fa-solid fa-moon text-xl hidden"></i></button></div></nav></header><main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 sm:py-12 max-w-4xl"><div class="mb-8"><div class="border-b w-full overflow-x-auto" id="tab-nav"><nav class="flex gap-1 min-w-max" aria-label="Tabs"><button class_default="px-4 py-3 text-sm font-medium hover:border-stone-300 border-b-2 border-transparent transition-all duration-200 whitespace-nowrap" class_active="px-4 py-3 text-sm font-medium border-b-2 border-stone-900 whitespace-nowrap" data-tab="kosakata" class="px-4 py-3 text-sm font-medium border-b-2 border-stone-900 whitespace-nowrap">Kosakata</button> <button class_default="px-4 py-3 text-sm font-medium hover:border-stone-300 border-b-2 border-transparent transition-all duration-200 whitespace-nowrap" class_active="px-4 py-3 text-sm font-medium border-b-2 border-stone-900 whitespace-nowrap" data-tab="polakalimat" class="px-4 py-3 text-sm font-medium hover:border-stone-300 border-b-2 border-transparent transition-all duration-200 whitespace-nowrap">Pola Kalimat</button> <button class_default="px-4 py-3 text-sm font-medium hover:border-stone-300 border-b-2 border-transparent transition-all duration-200 whitespace-nowrap" class_active="px-4 py-3 text-sm font-medium border-b-2 border-stone-900 whitespace-nowrap" data-tab="video" class="px-4 py-3 text-sm font-medium hover:border-stone-300 border-b-2 border-transparent transition-all duration-200 whitespace-nowrap">Video</button> <button class_default="px-4 py-3 text-sm font-medium hover:border-stone-300 border-b-2 border-transparent transition-all duration-200 whitespace-nowrap" class_active="px-4 py-3 text-sm font-medium border-b-2 border-stone-900 whitespace-nowrap" data-tab="quiz" class="px-4 py-3 text-sm font-medium hover:border-stone-300 border-b-2 border-transparent transition-all duration-200 whitespace-nowrap">Quiz</button> <button class_default="px-4 py-3 text-sm font-medium hover:border-stone-300 border-b-2 border-transparent transition-all duration-200 whitespace-nowrap" class_active="px-4 py-3 text-sm font-medium border-b-2 border-stone-900 whitespace-nowrap" data-tab="reading" class="px-4 py-3 text-sm font-medium hover:border-stone-300 border-b-2 border-transparent transition-all duration-200 whitespace-nowrap">Reading</button> <button class_default="px-4 py-3 text-sm font-medium hover:border-stone-300 border-b-2 border-transparent transition-all duration-200 whitespace-nowrap" class_active="px-4 py-3 text-sm font-medium border-b-2 border-stone-900 whitespace-nowrap" data-tab="listening" class="px-4 py-3 text-sm font-medium hover:border-stone-300 border-b-2 border-transparent transition-all duration-200 whitespace-nowrap">Listening</button></nav></div></div><div id="tab-content"><div id="kosakata" class="tab-pane active"><div id="vocab-content"><p class="text-sm">Memuat kosakata...</p></div></div><div id="polakalimat" class="tab-pane hidden"><div id="grammar-content" class="space-y-8"><p class="text-sm">Memuat pola kalimat...</p></div></div><div id="video" class="tab-pane hidden"><div id="video-content" class="space-y-8"><p class="text-sm">Memuat video...</p></div></div><div id="quiz" class="tab-pane hidden"><div id="quiz-stats" class="space-y-8"><p class="text-sm">Jika kamu sudah memahami kosakata dan pola kalimat silahkan kerjakan quiz untuk menguji pemahaan pola kalimat kamu,</p><a id="quiz-button" href="#" class="inline-flex items-center justify-center w-full sm:w-auto px-6 py-3 text-sm font-medium text-white bg-white dark:bg-gray-900 dark:rounded-lg transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-stone-900 focus:ring-offset-2">Start Quiz</a></div></div><div id="reading" class="tab-pane hidden"><div id="reading-content" class="space-y-12"><p class="text-sm">Memuat latihan membaca...</p></div><div id="dokkai-results" class="hidden mt-8"></div></div><div id="listening" class="tab-pane hidden"><div id="listening-content" class="space-y-6"><p class="text-sm">Memuat latihan mendengar...</p></div></div></div></main><div id="image-modal" class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-75 backdrop-blur-sm hidden"><div class="relative p-4 bg-transparent rounded-lg shadow-xl max-w-4xl w-full mx-4"><button id="modal-close-btn" class="absolute -top-3 -right-3 w-8 h-8 bg-white dark:bg-stone-700 text-stone-900 dark:text-stone-100 rounded-full flex items-center justify-center shadow-lg focus:outline-none focus:ring-2 focus:ring-stone-900 dark:focus:ring-stone-100 z-50" aria-label="Tutup modal"><i class="fa-solid fa-times"></i></button><div class="swiper modal-swiper"><div id="swiper-wrapper-modal" class="swiper-wrapper"></div><div class="swiper-button-next"></div><div class="swiper-button-prev"></div><div class="swiper-pagination"></div></div></div></div><div id="welcome-modal" class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-75 backdrop-blur-sm hidden"><div class="bg-white dark:bg-stone-800 border border-stone-200 dark:border-stone-700 rounded-lg shadow-xl max-w-md w-full max-h-[80vh] overflow-y-auto p-6 md:p-8 mx-4 scrollbar-thin scrollbar-thumb-stone-300 dark:scrollbar-thumb-stone-700 scrollbar-track-transparent"><h2 class="text-xl font-semibold text-stone-900 dark:text-stone-100 tracking-tight mb-4 text-center">Update version 1.0 & released new fitur!</h2><div class="text-sm text-stone-600 dark:text-stone-400 leading-relaxed space-y-4"><p>Sebelum belajar silahkan pahami panel-panel berikut ya!</p><ul class="list-disc list-inside space-y-1"><li><b>Kosakata</b> – berisi daftar kosakata penting yang disusun per bab untuk memudahkan penguasaan kata dasar.</li><li><b>Pola Kalimat</b> – penjelasan pola kalimat lengkap dengan contoh agar kamu memahami struktur bahasa Jepang secara bertahap dibawahnya terdapat fitur baru <b class="text-blue-500">latihan membuat kalimat</b> yang nantinya kalimat kamu di koreksi otomatis oleh AI yang canggih</li><li><b class="text-blue-500">Video</b> - sekarang halaman ini berisi materi pembelajaran berbentuk video untuk membantu memahami konsep secara visual.</li><li><b>Kuis</b> – latihan soal interaktif untuk menguji pemahaman setelah mempelajari materi.</li><li><b>Reading</b> – bacaan pendek yang membantu melatih kemampuan membaca dan memahami konteks.</li><li><b>Listening</b> – latihan mendengarkan agar kamu terbiasa menangkap percakapan bahasa Jepang.</li></ul><p>Disarankan untuk memulai dari tab <b>Kosakata</b> terlebih dahulu, kemudian lanjut ke <b>Pola Kalimat</b> agar lebih mudah memahami struktur bahasa.</p><p>Halaman ini dilengkapi dengan dua mode tampilan, yaitu <b>Dark Mode</b> dan <b>Light Mode</b> untuk kenyamanan belajar.</p><p>Kamu juga bisa mengaktifkan fitur <b>Show Romaji</b> di dekat pengaturan mode tampilan, untuk membantu membaca huruf hiragana.</p><p>Silakan belajar secara mandiri dan tetap semangat, ya!</p></div><button id="modal-understand-btn" class="w-full mt-6 inline-flex items-center justify-center px-6 py-3 text-sm font-medium text-white dark:text-stone-900 bg-stone-900 dark:bg-stone-100 hover:bg-stone-800 dark:hover:bg-stone-200 rounded-lg transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-stone-900 dark:focus:ring-stone-100 focus:ring-offset-2 dark:focus:ring-offset-stone-800">Baik!</button></div></div><script>document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("welcome-modal"),t=document.getElementById("modal-understand-btn");localStorage.getItem("introduction-panel")||e.classList.remove("hidden"),t.addEventListener("click",()=>{e.classList.add("hidden"),localStorage.setItem("introduction-panel","true")})});</script><div id="vocab-detail-modal" class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-75 backdrop-blur-sm hidden transition-opacity duration-300"><div class="relative bg-white dark:bg-stone-800 rounded-xl shadow-2xl max-w-lg w-full mx-4 overflow-hidden transform transition-all duration-300 scale-100 border border-stone-200 dark:border-stone-700"><button id="vocab-modal-close" class="absolute top-4 right-4 w-8 h-8 bg-black/10 dark:bg-white/10 hover:bg-black/20 dark:hover:bg-white/20 text-stone-800 dark:text-stone-200 rounded-full flex items-center justify-center transition-colors z-10"><i class="fa-solid fa-times"></i></button><div id="vocab-modal-image-container" class="w-full h-64 bg-stone-100 dark:bg-stone-900 flex items-center justify-center overflow-hidden relative"><i class="fa-solid fa-image text-4xl text-stone-300 dark:text-stone-600"></i></div><div class="p-6 md:p-8 text-center space-y-4"><div><h3 id="vocab-modal-word" class="js-romaji-target text-3xl md:text-4xl font-bold text-stone-900 dark:text-stone-100 tracking-tight mb-2"></h3><div class="h-1 w-12 bg-stone-300 dark:bg-stone-600 mx-auto rounded-full"></div></div><p id="vocab-modal-meaning" class="text-lg md:text-xl text-stone-600 dark:text-stone-400 font-medium leading-relaxed"></p></div></div></div><div id="exercise-modal" class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-75 backdrop-blur-sm hidden transition-opacity duration-300"><div class="relative bg-white dark:bg-stone-800 rounded-xl shadow-2xl max-w-xl w-full mx-4 overflow-hidden transform transition-all duration-300 scale-100 border border-stone-200 dark:border-stone-700"><button id="exercise-modal-close" class="absolute top-4 right-4 w-8 h-8 bg-black/10 dark:bg-white/10 hover:bg-black/20 dark:hover:bg-white/20 text-stone-800 dark:text-stone-200 rounded-full flex items-center justify-center transition-colors z-10"><i class="fa-solid fa-times"></i></button><div class="p-6 md:p-8 space-y-4"><h3 id="exercise-modal-pattern" class="text-xl font-bold text-stone-900 dark:text-stone-100 tracking-tight mb-4 border-b pb-3 border-stone-200 dark:border-stone-700"></h3><p class="text-sm text-stone-600 dark:text-stone-400 leading-relaxed mb-4">Buatlah dua kalimat Bahasa Jepang menggunakan pola kalimat di atas.</p><form id="sentence-check-form" class="space-y-4"><input type="hidden" id="modal-pattern-data"> <input type="hidden" id="modal-explanation-data"> <input type="hidden" id="modal-example-data"><div><label for="user-sentence" class="block text-sm font-medium text-stone-700 dark:text-stone-300 mb-2">Kalimat Kamu:</label> <textarea type="text" id="user-sentence" rows="6" name="user-sentence" required class="w-full px-4 py-2.5 text-sm text-stone-900 dark:text-stone-100 bg-stone-50 dark:bg-stone-700 border border-stone-300 dark:border-stone-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-stone-900 dark:focus:ring-stone-400 transition-all duration-200" placeholder="ketik dengan huruf hiragana pastikan keyboardmu mendukung hiragana ya!"></textarea></div><div id="feedback-area" class="hidden p-4 rounded-lg border text-sm transition-all duration-300"><p class="font-semibold mb-2" id="feedback-title"></p><p id="feedback-message"></p></div><button type="submit" id="check-sentence-btn" class="w-full inline-flex items-center justify-center px-6 py-3 text-sm font-medium text-white bg-green-600 text-white rounded-lg transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-stone-900 focus:ring-offset-2">Cek Kalimat</button> <button type="button" id="try-again-btn" class="hidden w-full inline-flex items-center justify-center px-6 py-3 text-sm font-medium text-stone-700 dark:text-stone-300 bg-stone-100 dark:bg-stone-700 hover:bg-stone-200 dark:hover:bg-stone-600 rounded-lg transition-colors duration-200">Coba Lagi</button></form></div></div></div><script type="module">import"https://cdn.jsdelivr.net/npm/@uploadcare/uc-video/dist/uc-video.js";</script><script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script><script>var m=(v,L,u)=>new Promise((k,g)=>{var E=c=>{try{l(u.next(c))}catch(p){g(p)}},x=c=>{try{l(u.throw(c))}catch(p){g(p)}},l=c=>c.done?k(c.value):Promise.resolve(c.value).then(E,x);l((u=u.apply(v,L)).next())});const urlParams=new URLSearchParams(window.location.search),babId=urlParams.get("babId"),vocabContainer=document.getElementById("vocab-content"),grammarContainer=document.getElementById("grammar-content"),videoContainer=document.getElementById("video-content"),readingContainer=document.getElementById("reading-content"),listeningContainer=document.getElementById("listening-content"),quizStats=document.getElementById("quiz-stats"),titleEl=document.getElementById("chapter-title"),quizButton=document.getElementById("quiz-button"),modal=document.getElementById("image-modal"),modalCloseBtn=document.getElementById("modal-close-btn"),vocabDetailModal=document.getElementById("vocab-detail-modal"),vocabModalCloseBtn=document.getElementById("vocab-modal-close"),vocabModalImageContainer=document.getElementById("vocab-modal-image-container"),vocabModalWord=document.getElementById("vocab-modal-word"),vocabModalMeaning=document.getElementById("vocab-modal-meaning"),exerciseModal=document.getElementById("exercise-modal"),exerciseModalCloseBtn=document.getElementById("exercise-modal-close"),exerciseModalPattern=document.getElementById("exercise-modal-pattern"),sentenceCheckForm=document.getElementById("sentence-check-form"),userSentenceInput=document.getElementById("user-sentence"),checkSentenceBtn=document.getElementById("check-sentence-btn"),tryAgainBtn=document.getElementById("try-again-btn"),feedbackArea=document.getElementById("feedback-area"),feedbackTitle=document.getElementById("feedback-title"),feedbackMessage=document.getElementById("feedback-message"),modalPatternData=document.getElementById("modal-pattern-data"),modalExplanationData=document.getElementById("modal-explanation-data"),modalExampleData=document.getElementById("modal-example-data"),mainContent=document.querySelector("main");let modalSwiper=null;const ROMAJI_PREF_KEY="romaji-preference";if(!babId)document.body.innerHTML='<div class="text-center p-10"><h1 class="text-2xl font-bold text-red-600">Error: ID Bab tidak ditemukan.</h1><a href="/" class="text-blue-500 hover:underline">Kembali ke Home</a></div>';else{let v=function(t){const e=t.find(n=>n.id==babId);e?(titleEl.textContent=e.title,document.title=`Belajar - ${e.title}`):titleEl.textContent="Bab Tidak Ditemukan"},u=function(t){if(vocabContainer.innerHTML="",t.length===0){vocabContainer.innerHTML='<p class="text-sm">Coming soon.</p>';return}let e="",n=!1;t.forEach(s=>{if(s.item_type==="divider")n&&(e+="</div>",n=!1),e+=`
 <h2 class="js-romaji-target text-xl font-semibold text-stone-800 dark:text-stone-200 pt-6 pb-3 mb-3 border-b border-stone-200 dark:border-stone-700">
 ${s.kosakata}
 </h2>
 `;else if(s.item_type==="vocab"){n||(e+='<div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4">',n=!0);const o=s.image_url?`<img src="${s.image_url}" alt="${s.kosakata}" class="w-full h-32 object-cover transition-transform duration-300 group-hover:scale-105">`:`<div class="w-full h-32 vocab-card-image-placeholder bg-stone-50 dark:bg-stone-700 group-hover:bg-stone-100 dark:group-hover:bg-stone-600 transition-colors">
 <i class="fa-solid fa-image text-3xl text-stone-300 dark:text-stone-500"></i>
</div>`,a=JSON.stringify(s).replace(/'/g,"&#39;");e+=`
 <div class="vocab-card group bg-white dark:bg-stone-800 rounded-lg shadow-sm border border-stone-200 dark:border-stone-700 overflow-hidden transition-all duration-200 hover:shadow-lg hover:-translate-y-1 cursor-pointer" data-vocab='${a}'>
 ${o}
 <div class="p-4">
 <h3 class="js-romaji-target text-lg font-semibold text-stone-900 dark:text-stone-100 group-hover:text-stone-700 dark:group-hover:text-stone-300 transition-colors">${s.kosakata||""}</h3>
 <p class="text-sm text-stone-600 dark:text-stone-400 mt-1 truncate">${s.arti||""}</p>
 </div>
 </div>
 `}}),n&&(e+="</div>"),vocabContainer.innerHTML=e},k=function(t){if(!t)return;vocabModalWord.innerHTML=t.kosakata||"",vocabModalWord.dataset.originalHtml=t.kosakata||"",vocabModalMeaning.textContent=t.arti||"",t.image_url?vocabModalImageContainer.innerHTML=`<img src="${t.image_url}" alt="${t.kosakata}" class="w-full h-full object-contain">`:vocabModalImageContainer.innerHTML='<i class="fa-solid fa-image text-6xl text-stone-300 dark:text-stone-600"></i>',vocabDetailModal.classList.remove("hidden"),b()&&f(!0)},g=function(){vocabDetailModal.classList.add("hidden")},x=function(t,e,n){exerciseModalPattern.textContent=t,modalPatternData.value=t,modalExplanationData.value=e.replace(/<[^>]*>?/gm,""),modalExampleData.value=n.replace(/<[^>]*>?/gm,""),userSentenceInput.value="",feedbackArea.classList.add("hidden"),checkSentenceBtn.classList.remove("hidden"),tryAgainBtn.classList.add("hidden"),userSentenceInput.disabled=!1,exerciseModal.classList.remove("hidden"),userSentenceInput.focus()},l=function(){exerciseModal.classList.add("hidden")},c=function(t){if(!t)return{type:"unknown"};const e=t.match(/(?:youtube\.com\/(?:[^\/]+\/.+\/|embed\/|v\/|watch\?v=)|youtu\.be\/)([^&?]*)/);if(e&&e[1].length===11)return{type:"youtube",id:e[1]};const n=t.match(/([a-f0-9]{32})/i);return n?{type:"uploadcare",uuid:n[1],url:t}:t.startsWith("http")?{type:"direct_media",url:t}:{type:"unknown"}},p=function(t){videoContainer.innerHTML="";const e=t.filter(n=>n.video_url);if(e.length===0){videoContainer.innerHTML='<p class="text-sm text-stone-500 dark:text-stone-400">Tidak ada video course untuk bab ini.</p>';return}e.forEach(n=>{const s=n.video_url,o=c(s);let a="",r="";o.type==="youtube"?(a=`
                <div class="aspect-video bg-black rounded-lg overflow-hidden youtube-container">
                    <iframe 
                        src="https://www.youtube.com/embed/${o.id}?rel=0&controls=1" 
                        frameborder="0" allowfullscreen 
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                        class="w-full h-full"
                    ></iframe>
                </div>
            `,r="Video ini disajikan melalui YouTube."):o.type==="uploadcare"?(a=`
                <div class="aspect-video bg-black rounded-lg overflow-hidden">
                    <uc-video
                        uuid="${o.uuid}"
                        cdnCname="https://ucarecdn.com/" 
                        controls 
                        playsinline 
                        showLogo="false"
                        class="w-full h-full"
                    ></uc-video>
                </div>
            `,r="Silahkan tonton video berikut jika kamu belum memahami pola kalimat ya!"):o.type==="direct_media"?(a=`
                <div class="aspect-video bg-black rounded-lg overflow-hidden">
                    <video controls class="w-full h-full" poster="" crossorigin="anonymous">
                        <source src="${o.url}" type="video/mp4">
                        Maaf, browser Anda tidak mendukung tag video HTML5 atau gagal memuat file.
                    </video>
                </div>
            `,r="Silahkan tonton video di atas jikaa belum memahami pola kalimat"):(a=`<p class="text-sm text-red-500">URL (${s}) tidak dikenali sebagai YouTube atau link media langsung (CDN).</p>`,r="Silakan periksa URL yang dimasukkan admin."),videoContainer.innerHTML+=`
            <div class="video-card py-6 border-b border-stone-100 last:border-b-0">
                <h3 class="js-romaji-target text-xl font-semibold text-stone-900 mb-4 tracking-tight">${n.pattern}</h3>
                <div class="mb-6">
                    ${a}
                </div>
                <p class="text-xs text-stone-500 dark:text-stone-400 mt-2 italic">${r}</p>
            </div>
        `})},T=function(t){if(grammarContainer.innerHTML="",t.length===0){grammarContainer.innerHTML='<p class="text-sm">Belum ada pola kalimat untuk bab ini.</p>';return}t.forEach(e=>{let n="";const s=Array.isArray(e.image_urls)?e.image_urls:[];if(s.length>0){n='<div class="flex flex-wrap gap-2 mb-4">';const a=JSON.stringify(s);s.forEach((r,i)=>{r&&(n+=`
 <div>
  <img src="${r}" 
 alt="Ilustrasi" 
 class="bunpou-image w-32 h-32 object-cover rounded-lg border border-stone-200 cursor-pointer transition-transform duration-200 hover:scale-[1.05]"
 data-group-images='${a}' 
 data-image-index="${i}"
  >
 </div>
 `)}),n+="</div>"}const o=`
                <button type="button" 
                    class="open-exercise-modal-btn inline-flex items-center px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-600 focus:ring-offset-2 mt-4"
                    data-pattern="${e.pattern.replace(/"/g,"&quot;")}"
                    data-explanation="${e.explanation.replace(/"/g,"&quot;")}"
                    data-example="${e.example.replace(/"/g,"&quot;")}"
                    >
                    <i class="fa-solid fa-pen-to-square mr-2"></i> Ayo Latihan!
                </button>
            `;grammarContainer.innerHTML+=`
 <div class="grammar-card py-6 border-b border-stone-100 last:border-b-0">
 <h3 class="js-romaji-target text-xl font-semibold text-stone-900 mb-4 tracking-tight">${e.pattern}</h3>
 
 <div class="space-y-4">
  <div>
  <h4 class="text-xs font-medium text-stone-500 uppercase tracking-wide mb-2">Penjelasan</h4>
  <div class="ql-container">
   <div class="ql-editor leading-relaxed">${e.explanation||"N/A"}</div>
  </div>
  </div>
  <div>
  <h4 class="text-xs font-medium text-stone-500 uppercase tracking-wide mb-2">Contoh</h4>
  <div class="ql-container">
   <div class="js-romaji-target ql-editor leading-relaxed">${e.example||"N/A"}</div>
  </div>
  <p class="text-sm mb-3 text-stone-600 leading-relaxed dark:text-stone-400">Klik gambar untuk melihat pola kalimat</p>
       ${n} 
  ${o}
  </div>
 </div>
 </div>
 `}),grammarContainer.querySelectorAll(".open-exercise-modal-btn").forEach(e=>{e.addEventListener("click",()=>{const n=e.dataset.pattern,s=e.dataset.explanation,o=e.dataset.example;x(n,s,o)})})},B=function(t){if(readingContainer.innerHTML="",!t||t.length===0){readingContainer.innerHTML='<p class="text-sm">Coming soon.</p>';return}let e='<form id="dokkai-form">';t.forEach((s,o)=>{e+=`
 <div class="bg-white p-6 rounded-lg border border-stone-200 mb-8">
 <h3 class="text-lg font-semibold text-stone-900 mb-4">\u8AAD\u89E3 ${o+1}</h3>
 <div class="mb-6">
  <h4 class="text-xs font-medium text-stone-500 uppercase tracking-wide mb-2">Wacana</h4>
  <div class="ql-container rounded-lg">
  <div class="js-romaji-target ql-editor leading-relaxed">${s.passage_content||""}</div>
  </div>
 </div>
 <div>
  <h4 class="text-xs font-medium text-stone-500 uppercase tracking-wide mb-4">Pertanyaan</h4>
  <div class="space-y-6">
  `,s.questions&&s.questions.length>0?s.questions.forEach((a,r)=>{e+=`
 <div class="border-t border-stone-100 pt-6 first:border-t-0 first:pt-0">
  <p class="js-romaji-target text-base font-medium text-stone-800 mb-4">${r+1}. ${a.question_text||""}</p>
  <div class="space-y-3">
  <label class="flex items-center p-3 border border-stone-200 rounded-lg hover:bg-stone-50 transition-colors cursor-pointer">
   <input type="radio" name="dokkai_q_${a.id}" value="A" class="mr-3 text-stone-900 focus:ring-stone-900" required>
   <span class="js-romaji-target text-sm text-stone-700">A. ${a.option_a||""}</span>
  </label>
  <label class="flex items-center p-3 border border-stone-200 rounded-lg hover:bg-stone-50 transition-colors cursor-pointer">
   <input type="radio" name="dokkai_q_${a.id}" value="B" class="mr-3 text-stone-900 focus:ring-stone-900" required>
   <span class="js-romaji-target text-sm text-stone-700">B. ${a.option_b||""}</span>
  </label>
  <label class="flex items-center p-3 border border-stone-200 rounded-lg hover:bg-stone-50 transition-colors cursor-pointer">
   <input type="radio" name="dokkai_q_${a.id}" value="C" class="mr-3 text-stone-900 focus:ring-stone-900" required>
   <span class="js-romaji-target text-sm text-stone-700">C. ${a.option_c||""}</span>
  </label>
  <label class="flex items-center p-3 border border-stone-200 rounded-lg hover:bg-stone-50 transition-colors cursor-pointer">
   <input type="radio" name="dokkai_q_${a.id}" value="D" class="mr-3 text-stone-900 focus:ring-stone-900" required>
   <span class="js-romaji-target text-sm text-stone-700">D. ${a.option_d||""}</span>
  </label>
  </div>
 </div>
 `}):e+='<p class="text-sm text-stone-500">Wacana ini belum memiliki pertanyaan.</p>',e+="</div></div></div>"}),t.some(s=>s.questions&&s.questions.length>0)&&(e+=`
 <button type="submit" class="inline-flex items-center justify-center w-full px-6 py-3 text-sm font-medium text-white bg-stone-900 hover:bg-stone-800 rounded-lg transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-stone-900 focus:ring-offset-2">
  Kumpulkan Jawaban Dokkai
 </button>
 `),e+="</form>",readingContainer.innerHTML=e;const n=document.getElementById("dokkai-form");n&&n.addEventListener("submit",S)},$=function(t){const e=document.getElementById("dokkai-results");e.innerHTML=`
 <div class="bg-white p-6 rounded-lg border border-stone-200">
 <h3 class="text-xl font-semibold text-stone-900 mb-4">Hasil Latihan Membaca</h3>
 <p class="text-lg">Skor Anda: <span class="font-bold text-green-600">${t.score}</span> / ${t.total}</p>
 </div>
 `,e.classList.remove("hidden"),e.scrollIntoView({behavior:"smooth",block:"center"}),t.results.forEach(n=>{const s=n.questionId;document.getElementsByName(`dokkai_q_${s}`).forEach(a=>{a.disabled=!0;const r=a.closest("label");r.classList.remove("hover:bg-stone-50","cursor-pointer"),a.value===n.correctAnswer&&r.classList.add("bg-green-100","border-green-300"),a.checked&&!n.isCorrect&&r.classList.add("bg-red-100","border-red-300")})}),document.getElementById("dokkai-form").querySelector('button[type="submit"]').classList.add("hidden"),f(b())},M=function(t){if(listeningContainer.innerHTML="",t.length===0){listeningContainer.innerHTML='<p class="text-sm">Coming soon.</p>';return}t.forEach((e,n)=>{const s=e.image_url||"",o=e.description&&e.description.trim()!==""&&e.description.trim()!=="<p><br></p>",a=e.script&&e.script.trim()!==""&&e.script.trim()!=="<p><br></p>";let r="";e.audio_urls&&e.audio_urls.length>0?e.audio_urls.forEach((i,d)=>{i&&(r+=`
  <div class="flex justify-center">
  <a
  href="${i}"
  class="inline-flex items-center justify-center w-full sm:w-auto px-6 py-3 text-sm font-medium text-white bg-stone-900 hover:bg-stone-800 rounded-lg transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-stone-900 focus:ring-offset-2"
a  >
  Audio ${d+1}
  </a>
  </div>
 `)}):r='<p class="text-sm text-red-500">Audio tidak ditemukan.</p>',listeningContainer.innerHTML+=`
 <div class="bg-white p-6 rounded-lg border border-stone-200 space-y-4">
 <h3 class="js-romaji-target text-lg font-semibold text-stone-900">
 ${e.title||`Latihan Mendengar ${n+1}`}
 </h3>
 ${o?`
 <div class="pb-4 border-b border-stone-100">
  <h4 class="text-xs font-medium text-stone-500 uppercase tracking-wide mb-2">
  Petunjuk
  </h4>
  <div class="ql-container">
  <div class="ql-editor">${e.description}</div>
  </div>
 </div>
 `:""}
 ${s?`
 <div>
  <img
  src="${s}"
  alt="Gambar untuk ${e.title||"latihan"}"
  class="w-full max-h-80 object-contain rounded-lg bg-stone-100"
  >
 </div>
 `:""}
 ${r}
 ${a?`
 <div class="pt-4 border-t border-stone-100">
  <button
  type="button"
  class="toggle-script-btn text-sm font-medium text-stone-600 hover:text-stone-900 transition-colors duration-200 flex items-center gap-2"
  data-target="script-${e.id}"
 _ >
  <i class="fa-solid fa-eye w-4"></i>
  <span>Tampilkan Teks Jawaban</span>
  </button>
  <div id="script-${e.id}" class="choukai-script-container">
  <div class="ql-container">
  <div class="js-romaji-target ql-editor">${e.script}</div>
  </div>
  </div>
 </div>
 `:""}
 </div>
 `}),j()},j=function(){listeningContainer.addEventListener("click",t=>{const e=t.target.closest(".toggle-script-btn");if(!e)return;const n=e.dataset.target,s=document.getElementById(n),o=e.querySelector("i"),a=e.querySelector("span");s&&(s.classList.toggle("visible")?(o.classList.remove("fa-eye"),o.classList.add("fa-eye-slash"),a.textContent="Sembunyikan Teks Jawaban",f(b())):(o.classList.remove("fa-eye-slash"),o.classList.add("fa-eye"),a.textContent="Tampilkan Teks Jawaban"))})},w=function(t,e){if(!modal)return;const n=document.getElementById("swiper-wrapper-modal");n&&(n.innerHTML="",t.forEach(s=>{n.innerHTML+=`
 <div class="swiper-slide">
  <div class="swiper-zoom-container">
    <img src="${s}" alt="Gambar Bunpou" />
  </div>
 </div>
 `}),modal.classList.remove("hidden"),modalSwiper&&modalSwiper.destroy(),modalSwiper=new Swiper(".modal-swiper",{initialSlide:e,loop:t.length>1,pagination:{el:".swiper-pagination",clickable:!0},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},keyboard:{enabled:!0},zoom:{maxRatio:5,toggle:!0}}))},y=function(){if(!modal)return;modal.classList.add("hidden"),modalSwiper&&(modalSwiper.destroy(),modalSwiper=null);const t=document.getElementById("swiper-wrapper-modal");t&&(t.innerHTML="")},b=function(){return localStorage.getItem(ROMAJI_PREF_KEY)==="true"},C=function(t){localStorage.setItem(ROMAJI_PREF_KEY,t),I(t),f(t)},H=function(){const t=b();C(!t)},I=function(t){const e=document.getElementById("romaji-toggle-btn"),n=document.getElementById("romaji-toggle-icon");!e||!n||(t?(e.classList.add("bg-stone-800","text-white"),e.classList.add("dark:bg-stone-200","dark:text-stone-900"),n.textContent="A"):(e.classList.remove("bg-stone-800","text-white"),e.classList.remove("dark:bg-stone-200","dark:text-stone-900"),n.textContent="\u3042"))},f=function(t){document.querySelectorAll(".js-romaji-target").forEach(n=>{if(n.dataset.originalHtml===void 0&&(n.dataset.originalHtml=n.innerHTML||""),t){let r=function(i){i.nodeType===Node.TEXT_NODE?i.textContent.trim().length>0&&(i.textContent=wanakana.toRomaji(i.textContent,{upcaseKatakana:!0})):i.nodeType===Node.ELEMENT_NODE&&i.childNodes.forEach(r)};var s=r;const o=n.dataset.originalHtml;if(o===""){n.innerHTML="";return}const a=document.createElement("div");a.innerHTML=o,r(a),n.innerHTML=a.innerHTML}else n.innerHTML=n.dataset.originalHtml})};var renderChapterTitle=v,renderVocab=u,openVocabModal=k,closeVocabModal=g,openExerciseModal=x,closeExerciseModal=l,checkMediaType=c,renderVideos=p,renderGrammar=T,renderReading=B,renderDokkaiResults=$,renderListening=M,setupListeningToggles=j,openImageSwiperModal=w,closeModal=y,getRomajiPref=b,setRomajiPref=C,toggleRomajiPref=H,updateRomajiToggleButton=I,applyGlobalRomaji=f;quizButton.href=`/quiz?babId=${babId}`,document.getElementById("tab-nav").addEventListener("click",t=>{if(t.target.tagName==="BUTTON"){const e=t.target.dataset.tab;document.querySelectorAll(".tab-pane").forEach(n=>n.classList.add("hidden")),document.querySelectorAll("#tab-nav button").forEach(n=>{n.className=n.getAttribute("class_default")}),document.getElementById(e).classList.remove("hidden"),t.target.className=t.target.getAttribute("class_active"),t.target.classList.add("border-stone-900")}});function L(){return m(this,null,function*(){try{const e=yield(yield fetch("/api/chapters")).json();v(e)}catch(t){titleEl.textContent="Error"}})}function E(){return m(this,null,function*(){try{const e=yield(yield fetch(`/api/vocabularies/${babId}`)).json();u(e)}catch(t){vocabContainer.innerHTML='<p class="text-sm text-red-600">Gagal memuat kosakata.</p>'}})}exerciseModalCloseBtn.addEventListener("click",l),exerciseModal.addEventListener("click",t=>{t.target===exerciseModal&&l()}),sentenceCheckForm.addEventListener("submit",t=>m(null,null,function*(){t.preventDefault();const e=userSentenceInput.value.trim();if(e==="")return;checkSentenceBtn.disabled=!0,checkSentenceBtn.textContent="Memeriksa...",feedbackArea.classList.add("hidden");const n=modalPatternData.value,s=modalExplanationData.value,o=modalExampleData.value;try{const a=yield fetch("/api/grammar/check-sentence",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sentence:e,pattern:n,explanation:s,example:o})});if(!a.ok)throw new Error("Gagal memeriksa kalimat. Coba lagi.");const r=yield a.json();feedbackArea.classList.remove("hidden"),feedbackMessage.textContent=r.feedback_message,r.is_correct?(feedbackArea.classList.remove("bg-red-100","border-red-300","dark:bg-red-900/50","dark:border-red-700"),feedbackArea.classList.add("bg-green-100","border-green-300","dark:bg-green-900/50","dark:border-green-700"),feedbackTitle.textContent="\u2705 Benar! Kerja bagus!",checkSentenceBtn.classList.add("hidden"),tryAgainBtn.classList.remove("hidden"),tryAgainBtn.textContent="Tutup Latihan",userSentenceInput.disabled=!0):(feedbackArea.classList.remove("bg-green-100","border-green-300","dark:bg-green-900/50","dark:border-green-700"),feedbackArea.classList.add("bg-red-100","border-red-300","dark:bg-red-900/50","dark:border-red-700"),feedbackTitle.textContent="\u274C Ada Kesalahan:",tryAgainBtn.classList.remove("hidden"),tryAgainBtn.textContent="Coba Lagi")}catch(a){feedbackArea.classList.remove("hidden"),feedbackArea.classList.add("bg-red-100","border-red-300","dark:bg-red-900/50","dark:border-red-700"),feedbackTitle.textContent="\u26A0\uFE0F Error Teknis",feedbackMessage.textContent=a.message,tryAgainBtn.classList.remove("hidden"),tryAgainBtn.textContent="Tutup Latihan"}finally{checkSentenceBtn.disabled=!1,checkSentenceBtn.textContent="Cek Kalimat"}})),tryAgainBtn.addEventListener("click",()=>{tryAgainBtn.textContent==="Tutup Latihan"?l():(userSentenceInput.value="",feedbackArea.classList.add("hidden"),checkSentenceBtn.classList.remove("hidden"),tryAgainBtn.classList.add("hidden"),userSentenceInput.disabled=!1,userSentenceInput.focus())});function _(){return m(this,null,function*(){try{const e=yield(yield fetch(`/api/grammar/${babId}`)).json();T(e),p(e)}catch(t){grammarContainer.innerHTML='<p class="text-sm text-red-600">Gagal memuat pola kalimat.</p>',videoContainer.innerHTML='<p class="text-sm text-red-600">Gagal memuat video.</p>'}})}function q(){return m(this,null,function*(){try{const e=yield(yield fetch(`/api/reading/${babId}`)).json();B(e)}catch(t){readingContainer.innerHTML='<p class="text-sm text-red-600">Gagal memuat latihan membaca.</p>'}})}function S(t){return m(this,null,function*(){t.preventDefault();const e=t.target,n=new FormData(e),s=[];for(let[a,r]of n.entries())if(a.startsWith("dokkai_q_")){const i=parseInt(a.split("_")[2]);s.push({questionId:i,answer:r})}const o=e.querySelector('button[type="submit"]');o.disabled=!0,o.textContent="Memeriksa...";try{const a=yield fetch(`/api/submit-reading/${babId}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({answers:s})});if(!a.ok)throw new Error("Gagal mengirim jawaban");const r=yield a.json();$(r)}catch(a){o.disabled=!1,o.textContent="Error! Coba Lagi"}})}function D(){return m(this,null,function*(){try{const e=yield(yield fetch(`/api/listening/${babId}`)).json();M(e)}catch(t){listeningContainer.innerHTML='<p class="text-sm text-red-600">Gagal memuat latihan mendengar.</p>'}})}document.addEventListener("DOMContentLoaded",()=>{function t(){return m(this,null,function*(){yield L(),yield Promise.all([E(),_(),q(),D()]);const i=b();I(i),f(i)})}t();const e=document.getElementById("romaji-toggle-btn");e&&e.addEventListener("click",H),vocabContainer.addEventListener("click",i=>{const d=i.target.closest(".vocab-card");if(d)try{const h=JSON.parse(d.dataset.vocab);k(h)}catch(h){}}),vocabModalCloseBtn.addEventListener("click",g),vocabDetailModal.addEventListener("click",i=>{i.target===vocabDetailModal&&g()}),mainContent.addEventListener("click",i=>{const d=i.target.closest(".bunpou-image");if(d){i.preventDefault();try{const h=d.dataset.groupImages,A=JSON.parse(h),N=parseInt(d.dataset.imageIndex,10);w(A,N)}catch(h){w([d.src],0)}}}),modalCloseBtn.addEventListener("click",y),modal.addEventListener("click",i=>{i.target===modal&&y()}),window.addEventListener("keydown",i=>{i.key==="Escape"&&(modal.classList.contains("hidden")||y(),vocabDetailModal.classList.contains("hidden")||g(),exerciseModal.classList.contains("hidden")||l())});const n=document.getElementById("theme-toggle-btn"),s=document.getElementById("theme-icon-sun"),o=document.getElementById("theme-icon-moon"),a=document.documentElement;a.classList.contains("dark")?(s.classList.add("hidden"),o.classList.remove("hidden")):(s.classList.remove("hidden"),o.classList.add("hidden"));function r(i){i?(s.classList.add("hidden"),o.classList.remove("hidden")):(s.classList.remove("hidden"),o.classList.add("hidden"))}r(a.classList.contains("dark")),n.addEventListener("click",()=>{const i=a.classList.contains("dark"),d=i?"light":"dark";applyTheme(d),r(!i)})})}</script></body></html>